clear all
close all
clc

[simulation1, theoretical1] = awgn_ber_mpsk(1e5,2,0:1:35);
[simulation2, theoretical2] = awgn_ber_mpsk(1e5,3,0:1:35);
[simulation3, theoretical3] = awgn_ber_mpsk(1e5,4,0:1:35);
[simulation4, theoretical4] = awgn_ber_mpsk(1e5,6,0:1:35);

[simulation5, theoretical5] = awgn_ber_mqam(1e5,4,0:1:35);
[simulation6, theoretical6] = awgn_ber_mqam(1e5,6,0:1:35);

[simulation7, theoretical7] = rc_ber_mpsk(1e5,2,0:1:35);
[simulation8, theoretical8] = rc_ber_mpsk(1e5,3,0:1:35);
[simulation9, theoretical9] = rc_ber_mpsk(1e5,4,0:1:35);
[simulation10, theoretical10] = rc_ber_mpsk(1e5,6,0:1:35);
 
[simulation11, theoretical11] = rc_ber_mqam(1e5,4,0:1:35);
[simulation12, theoretical12] = rc_ber_mqam(1e5,6,0:1:35);


% plot
% all BER
semilogy(0:1:35, simulation1, 'k*', 0:1:35, theoretical1, 'k', ...
    0:1:35, simulation2, 'rd', 0:1:35, theoretical2, 'r', ...
    0:1:35, simulation3, 'bs', 0:1:35, theoretical3, 'b', ...
    0:1:35, simulation4, 'r+', 0:1:35, theoretical4, 'r', ...
    0:1:35, simulation5, 'cx', 0:1:35, theoretical5, 'c', ...
    0:1:35, simulation6, 'go', 0:1:35, theoretical6, 'g', ...
    0:1:35, simulation7, 'mp', 0:1:35, theoretical7, 'm', ...
    0:1:35, simulation8, 'ks', 0:1:35, theoretical8, 'k', ...
    0:1:35, simulation9, 'yh', 0:1:35, theoretical9, 'y', ...
    0:1:35, simulation10, 'mx', 0:1:35, theoretical10, 'm', ...
    0:1:35, simulation11, 'bs', 0:1:35, theoretical11, 'b', ...
    0:1:35, simulation12, 'c+', 0:1:35, theoretical12, 'c');

% only PSK
% semilogy(0:1:35, simulation1, 'k*', 0:1:35, theoretical1,'k', ...
%     0:1:35, simulation2, 'rd', 0:1:35, theoretical2, 'r', ...
%     0:1:35, simulation3, 'bs', 0:1:35, theoretical3, 'b', ...
%     0:1:35, simulation4, 'c+', 0:1:35, theoretical4, 'c', ...
%     0:1:35, simulation7, 'bp', 0:1:35, theoretical7, 'b', ...
%     0:1:35, simulation8, 'gp', 0:1:35, theoretical8, 'g', ...
%     0:1:35, simulation9, 'yh', 0:1:35, theoretical9, 'y', ...
%     0:1:35, simulation10, 'mx', 0:1:35, theoretical10, 'm');

% only QAM
% semilogy(0:1:35, simulation5, 'k*', 0:1:35, theoretical5, 'k', ...
%     0:1:35, simulation6, 'rd', 0:1:35, theoretical6, 'r', ...
%     0:1:35, simulation11, 'bs', 0:1:35, theoretical11, 'b', ...
%     0:1:35, simulation12, 'c+', 0:1:35, theoretical12, 'c');

% only AWGN
% semilogy(0:1:35, simulation1, 'k*', 0:1:35, theoretical1, 'k', ...
%     0:1:35, simulation2, 'rd', 0:1:35, theoretical2, 'r', ...
%     0:1:35, simulation3, 'bs', 0:1:35, theoretical3, 'b', ...
%     0:1:35, simulation4, 'r+', 0:1:35, theoretical4, 'r', ...
%     0:1:35, simulation5, 'cx', 0:1:35, theoretical5, 'c', ...
%     0:1:35, simulation6, 'go', 0:1:35, theoretical6, 'g');

%only AWGN PSK
% semilogy(0:1:35, simulation1, 'k*', 0:1:35, theoretical1, 'k', ...
%     0:1:35, simulation2, 'rd', 0:1:35, theoretical2, 'r', ...
%     0:1:35, simulation3, 'bs', 0:1:35, theoretical3, 'b', ...
%     0:1:35, simulation4, 'r+', 0:1:35, theoretical4, 'r');

% only AWGN QAM
% semilogy(0:1:35, simulation5, 'k*', 0:1:35, theoretical5, 'k', ...
%     0:1:35, simulation6, 'rd', 0:1:35, theoretical6, 'r');

% only AWGN QAM
% semilogy(0:1:35, simulation5, 'k*', 0:1:35, theoretical5, 'k');

% only Rayleigh
% semilogy(0:1:35, simulation7, 'mp', 0:1:35, theoretical7,'m', ...
%     0:1:35, simulation8, 'ks', 0:1:35, theoretical8,'k', ...
%     0:1:35, simulation9, 'yh', 0:1:35, theoretical9, 'y', ...
%     0:1:35, simulation10, 'gx', 0:1:35, theoretical10, 'g', ...
%     0:1:35, simulation11, 'bs', 0:1:35, theoretical11, 'b', ...
%     0:1:35, simulation12, 'c+', 0:1:35, theoretical12, 'c');

% only Rayleigh PSK
% semilogy(0:1:35, simulation7, 'mp', 0:1:35, BER2,'m', ...
%     0:1:35, simulation8, 'ks', 0:1:35, BER8,'k', ...
%     0:1:35, simulation9, 'bh', 0:1:35, BER16, 'b', ...
%     0:1:35, simulation10, 'rx', 0:1:35, BER64, 'r');


% legend
% all BER 
legend('BPSK simulation AWGN', 'BPSK theoretical AWGN', ...
    '8PSK simulation AWGN', '8PSK theoretical AWGN', ...
    '16PSK simulation  AWGN', '16PSK theoretical AWGN', ...
    '64PSK simulation AWGN', '64PSK theoretical AWGN', ...
    '16QAM simulation AWGN', '16QAM theoretical AWGN', ...
    '64QAM simulation AWGN', '64QAM theoretical AWGN', ...
    'BPSK simulation Rayleigh', 'BPSK theoretical Rayleigh', ...
    '8PSK simulation  Rayleigh', '8PSK theoretical Rayleigh', ...
    '16PSK simulation  Rayleigh', '16PSK theoretical Rayleigh', ...
    '64PSK simulation  Rayleigh', '64PSK theoretical Rayleigh', ...
    '16QAM simulation Rayleigh', '16QAM theoretical Rayleigh', ...
    '64QAM simulation Rayleigh', '64QAM theoretical Rayleigh');

% only PSK
% legend('BPSK simulation AWGN', 'BPSK theoretical AWGN', ...
%     '8PSK simulation AWGN', '8PSK theoretical AWGN', ...
%     '16PSK simulation  AWGN', '16PSK theoretical AWGN', ...
%     '64PSK simulation AWGN', '64PSK theoretical AWGN', ...
%     'BPSK simulation Rayleigh', 'BPSK theoretical Rayleigh', ...
%     '8PSK simulation Rayleigh', '8PSK theoretical Rayleigh', ...
%     '16PSK simulation Rayleigh', '16PSK theoretical Rayleigh', ...
%     '64PSK simulation Rayleigh', '64PSK theoretical Rayleigh');

% only QAM
% legend('16QAM simulation AWGN','16QAM theoretical AWGN', ...
%     '64QAM simulation AWGN','64QAM theoretical AWGN', ...
%     '16QAM simulation Rayleigh','16QAM theoretical Rayleigh', ...
%     '64QAM simulation Rayleigh', '64QAM theoretical Rayleigh');

% only AWGN
% legend('BPSK simulation AWGN', 'BPSK theoretical AWGN', ...
%     '8PSK simulation AWGN', '8PSK theoretical AWGN', ...
%     '16PSK simulation  AWGN', '16PSK theoretical AWGN',...
%     '64PSK simulation AWGN', '64PSK theoretical AWGN', ...
%     '16QAM simulation AWGN', '16QAM theoretical AWGN', ...
%     '64QAM simulation AWGN', '64QAM theoretical AWGN');

% only AWGN PSK
% legend('BPSK simulation AWGN', 'BPSK theoretical AWGN', ...
%     '8PSK simulation AWGN', '8PSK theoretical AWGN', ...
%     '16PSK simulation  AWGN', '16PSK theoretical AWGN',...
%     '64PSK simulation AWGN', '64PSK theoretical AWGN');

% only AWGN QAM
% legend('16QAM simulation AWGN','16QAM theoretical AWGN', ...
%     '64QAM simulation AWGN','64QAM theoretical AWGN');

% only AWGN QAM
% legend('16QAM simulation AWGN','16QAM theoretical AWGN');

% only Rayleigh
% legend('BPSK simulation Rayleigh', 'BPSK theoretical Rayleigh', ...
%     '8PSK simulation  Rayleigh', '8PSK theoretical Rayleigh', ...
%     '16PSK simulation Rayleigh', '16PSK theoretical Rayleigh', ...
%     '64PSK simulation Rayleigh', '64PSK theoretical Rayleigh', ...
%     '16QAM simulation Rayleigh', '16QAM theoretical Rayleigh', ...
%     '64QAM simulation Rayleigh', '64QAM theoretical Rayleigh');

% only Rayleigh PSK
% legend('BPSK simulation Rayleigh', 'BPSK theoretical Rayleigh', ...
%     '8PSK simulation  Rayleigh', '8PSK theoretical Rayleigh', ...
%     '16PSK simulation Rayleigh', '16PSK theoretical Rayleigh', ...
%     '64PSK simulation Rayleigh', '64PSK theoretical Rayleigh');

axis([0 35 1e-5 1]);
grid on
title('Bit error probability curve for different modulation techniques');
xlabel('Eb/No, dB');
ylabel('Bit Error Rate (BER)');